# Docker Compose for Mem0 WebUI - Development Mode
# 开发模式：使用 npm run dev，支持运行时环境变量
# 注意：开发模式性能较慢，仅用于开发/测试环境

version: '3.8'

services:
  # Mem0 WebUI 服务（开发模式）
  mem0-webui-dev:
    build:
      context: ../..
      dockerfile: deployment/mem0/webui.dev.Dockerfile
    container_name: mem0-webui-dev
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      # WebUI 通过容器名访问 API
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://mem0-api:8000}
      # 配置默认用户 ID
      NEXT_PUBLIC_USER_ID: ${NEXT_PUBLIC_USER_ID:-user}
      # Node.js 环境
      NODE_ENV: development
    depends_on:
      mem0-api:
        condition: service_started
    networks:
      - 1panel-network
    labels:
      createdBy: "Apps"
    # 开发模式：挂载源代码（可选，用于热重载）
    # volumes:
    #   - ../../projects/mem0/openmemory/ui:/app
    #   - /app/node_modules  # 防止覆盖 node_modules

networks:
  1panel-network:
    external: true

