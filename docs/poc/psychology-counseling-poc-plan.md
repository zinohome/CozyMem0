景化 POC 方案

**日期**: 2024-12-18  
**场景**: 心理咨询师为青少年提供心理支持和辅导

## 📋 POC 目标

验证三种记忆系统在心理咨询场景中的效果：
1. **Cognee (kb_psyc)**: 专业心理学知识库的作用
2. **Memobase**: 用户画像提取和积累
3. **Mem0**: 会话记忆和跨会话连续性

## 👤 用户设定

### 基础画像（预设）

```python
BASE_PROFILE = {
    "basic_info": {
        "name": "江小婉",
        "gender": "女",
        "age": 15,
        "location": "北京市",
        "school": "某重点中学",
        "grade": "高一"
    },
    "personality": {
        "traits": ["软弱", "内向"],
        "characteristics": "不善于表达自己的想法和感受"
    },
    "challenges": {
        "academic": "学习压力较大",
        "social": "与家人和同学沟通有困难",
        "emotional": "容易感到焦虑和无助"
    }
}
```

### 待提取画像（在会话中逐步发现）

```python
TO_EXTRACT_PROFILE = {
    "family_background": {
        "parents_relationship": "父母工作忙，缺少陪伴",
        "parenting_style": "高期望、严格要求",
        "siblings": "独生子女，缺少玩伴"
    },
    "academic_details": {
        "subjects": "数学和物理成绩不理想",
        "study_habits": "完美主义，对错误无法接受",
        "exam_anxiety": "考试前失眠、紧张"
    },
    "social_details": {
        "friendships": "班上没有特别要好的朋友",
        "bullying": "偶尔被同学取笑",
        "communication": "不敢表达自己的想法"
    },
    "emotional_state": {
        "mood": "经常感到孤独和委屈",
        "coping": "习惯性压抑情绪",
        "self_esteem": "自我评价低，容易自责"
    },
    "interests_strengths": {
        "hobbies": "喜欢画画和听音乐",
        "strengths": "观察力强，善于倾听",
        "dreams": "想成为心理咨询师帮助别人"
    }
}
```

## 🎯 三个会话场景设计

### 会话1：初次咨询 - 建立信任关系

**主题**: 学业压力和焦虑情绪  
**目标**: 
- 建立安全的咨询关系
- 了解来访者的基本情况
- 识别主要困扰

**10轮交流设计**:

1. **开场** - 咨询师欢迎，建立安全感
   - 用户：你好，我是小婉，老师让我来找你聊聊...
   
2. **了解来访原因** - 探索主诉
   - 用户：最近学习压力特别大，总是睡不好觉
   
3. **深入了解压力来源** - 具体化问题
   - 用户：主要是数学和物理成绩不好，我很努力了但还是考不好
   
4. **探索情绪反应** - 共情和理解
   - 用户：每次考试前我都特别紧张，手心出汗，心跳很快
   
5. **了解应对方式** - 评估资源
   - 用户：我就自己硬撑着，不敢跟父母说，他们会失望的
   
6. **家庭关系探索** - 了解支持系统
   - 用户：爸妈工作很忙，他们对我期望很高，总说我要考好大学
   
7. **社交关系探索** - 评估社会支持
   - 用户：班上我没什么朋友，大家都很优秀，我感觉跟不上他们
   
8. **自我认知探索** - 了解自我评价
   - 用户：我觉得自己很笨，什么都做不好...
   
9. **优势和资源识别** - 寻找积极面
   - 用户：我...我还挺喜欢画画的，画画的时候会觉得轻松一些
   
10. **总结和下次安排** - 巩固关系
    - 用户：谢谢老师，和你聊完我感觉好多了

### 会话2：深入探索 - 处理核心问题

**主题**: 完美主义和自我接纳  
**目标**:
- 探索完美主义倾向
- 处理自我价值感问题
- 教授情绪管理技巧

**10轮交流设计**:

1. **回顾上次咨询** - 建立连续性
   - 用户：老师你好，我是小婉，又来找你了
   
2. **近况汇报** - 了解变化
   - 用户：这周我尝试画画来放松，确实有点用
   
3. **探索完美主义** - 深入核心问题
   - 用户：但是我还是很焦虑，我不能接受自己犯错
   
4. **追溯根源** - 了解形成原因
   - 用户：从小爸妈就要求我什么都要做到最好，不能出错
   
5. **认知重构** - 挑战非理性信念
   - 用户：可是...如果我做不好，大家会觉得我很差吧
   
6. **情绪表达练习** - 鼓励表达
   - 用户：其实我心里很委屈，但我不敢说出来
   
7. **自我接纳探索** - 提升自我价值
   - 用户：我真的有优点吗？我觉得自己一无是处
   
8. **优势强化** - 积极心理学应用
   - 用户：画画...对，我画画还可以，老师说过我很有天赋
   
9. **技巧教授** - 情绪管理方法
   - 用户：下次焦虑的时候，我可以试试深呼吸和画画
   
10. **作业布置** - 巩固进步
    - 用户：好的，我会每天记录情绪日记，下次给你看

### 会话3：巩固成长 - 社交技能提升

**主题**: 人际沟通和社交焦虑  
**目标**:
- 提升沟通技能
- 建立社交信心
- 巩固咨询成果

**10轮交流设计**:

1. **成果回顾** - 肯定进步
   - 用户：老师，我坚持写了情绪日记，发现自己的变化
   
2. **新问题呈现** - 转向人际
   - 用户：现在学习焦虑好多了，但我还是不知道怎么和同学相处
   
3. **社交困难探索** - 具体化问题
   - 用户：我想和大家做朋友，但不知道怎么开口说话
   
4. **过往经验回顾** - 了解模式
   - 用户：之前有同学约我一起玩，但我紧张就拒绝了
   
5. **社交恐惧根源** - 深入了解
   - 用户：我怕说错话，怕别人觉得我很无趣
   
6. **认知重构** - 挑战消极想法
   - 用户：可能...大家并没有我想的那么在意吧
   
7. **技能训练** - 教授沟通技巧
   - 用户：我可以试着先从微笑和问候开始吗
   
8. **角色扮演** - 练习场景
   - 用户：如果同学主动找我聊天，我可以说...
   
9. **行动计划** - 制定目标
   - 用户：下周我试着和同桌多说几句话
   
10. **总结展望** - 肯定成长
    - 用户：谢谢老师，现在我觉得自己有力量去面对了

## 💬 心理咨询师系统提示词

```python
PSYCHOLOGY_COUNSELOR_SYSTEM_PROMPT = """
你是一位专业的青少年心理咨询师，拥有以下特质和能力：

# 专业背景
- 持有心理咨询师执业资格证书
- 擅长青少年心理辅导，特别是学业压力、人际关系、情绪管理
- 熟悉认知行为疗法(CBT)、人本主义疗法等多种咨询技术
- 了解青少年发展心理学和家庭系统理论

# 咨询态度
- 无条件积极关注：接纳来访者的一切表达，不评判
- 真诚共情：能够理解和感受来访者的情绪
- 温暖耐心：给予来访者安全感和信任感
- 尊重保密：严格遵守咨询伦理和保密原则

# 咨询技巧
1. **建立关系**：
   - 使用温暖、亲切的语气
   - 主动表达对来访者的关心
   - 创造安全、不受评判的空间

2. **倾听和共情**：
   - 认真倾听来访者的诉说
   - 准确反映来访者的情绪
   - 使用共情回应："我能感受到你..."

3. **提问技巧**：
   - 使用开放式问题探索
   - 避免"为什么"的追问
   - 循序渐进，不强迫表达

4. **干预方法**：
   - 认知重构：帮助识别和改变非理性信念
   - 情绪管理：教授具体的应对技巧
   - 行为实验：鼓励尝试新的行为模式
   - 优势视角：关注并强化积极资源

5. **适应青少年特点**：
   - 使用青少年能理解的语言
   - 避免说教和批评
   - 尊重青少年的自主性
   - 关注发展任务和同伴关系

# 咨询结构
每次咨询遵循以下结构：
1. 开场和建立连接（1-2分钟）
2. 回顾和近况了解（2-3分钟）
3. 深入探索当前问题（15-20分钟）
4. 干预和技能教授（10-15分钟）
5. 总结和作业布置（3-5分钟）

# 注意事项
- 根据来访者的表达调整咨询节奏
- 尊重来访者的防御机制，不强行突破
- 识别危机信号（自杀、自伤风险）
- 必要时建议家长参与或转介
- 保持专业界限，不提供个人建议

# 回应方式
- 简洁明了，避免长篇大论
- 每次回应控制在 2-3 段话
- 多用鼓励性语言
- 关注来访者的感受而非问题本身

记住：你的目标是帮助青少年认识自己、接纳自己、成长自己。
"""
```

## 🔬 对比测试方案

### 测试组设置

| 测试组 | kb_psyc | Memobase | Mem0 | 说明 |
|--------|---------|----------|------|------|
| **对照组** | ❌ | ❌ | ❌ | 基础 LLM，无任何记忆支持 |
| **仅知识库** | ✅ | ❌ | ❌ | 只使用心理学知识，无个性化 |
| **完整系统** | ✅ | ✅ | ✅ | 三种记忆系统全部启用 |

### 测试指标

#### 1. 专业性指标（kb_psyc 的作用）

- [ ] 是否使用专业心理学术语
- [ ] 是否运用认知行为疗法等技术
- [ ] 是否提供科学的应对策略
- [ ] 回应的专业深度

#### 2. 个性化指标（Memobase 的作用）

- [ ] 是否记住用户的基本信息（姓名、年龄、学校）
- [ ] 是否记住用户的核心困扰
- [ ] 是否记住用户的家庭背景
- [ ] 是否记住用户的兴趣爱好
- [ ] 回应是否体现对用户的了解

#### 3. 连续性指标（Mem0 的作用）

- [ ] 是否记住上次咨询的内容
- [ ] 是否追踪作业完成情况
- [ ] 跨会话时是否保持话题连贯
- [ ] 是否记住用户的进步和变化

#### 4. 效果指标

- [ ] 共情准确度
- [ ] 回应相关性
- [ ] 干预有效性
- [ ] 用户满意度（模拟评分）

### 对比测试流程

```python
TEST_FLOW = {
    "phase_1": {
        "name": "对照组测试",
        "config": {
            "user_id": "xiaowan_baseline",
            "dataset_names": [],  # 不使用知识库
            "enable_profile": False,
            "enable_memory": False
        },
        "sessions": [1, 2, 3]
    },
    "phase_2": {
        "name": "仅知识库测试",
        "config": {
            "user_id": "xiaowan_kb_only",
            "dataset_names": ["kb_psyc"],
            "enable_profile": False,
            "enable_memory": False
        },
        "sessions": [1, 2, 3]
    },
    "phase_3": {
        "name": "完整系统测试",
        "config": {
            "user_id": "xiaowan_full",
            "dataset_names": ["kb_psyc"],
            "enable_profile": True,
            "enable_memory": True
        },
        "sessions": [1, 2, 3]
    }
}
```

## 📊 数据准备方案

### 1. 基础画像注入（Memobase）

```python
# 在第一次对话前注入基础画像
BASE_PROFILE_MESSAGES = [
    {
        "role": "system",
        "content": "来访者基本信息：江小婉，女，15岁，北京市某重点中学高一学生"
    },
    {
        "role": "system",
        "content": "性格特点：软弱、内向，不善于表达情绪"
    },
    {
        "role": "system",
        "content": "主要困扰：学习压力大，与家人和同学沟通困难"
    }
]
```

### 2. 会话场景脚本

每个会话的完整对话脚本（30轮交流）存储为：
- `session_1_script.json` - 会话1：初次咨询
- `session_2_script.json` - 会话2：深入探索
- `session_3_script.json` - 会话3：巩固成长

### 3. 知识库内容验证

确保 `kb_psyc` 包含以下主题：
- [ ] 青少年发展心理学
- [ ] 认知行为疗法(CBT)
- [ ] 情绪管理技巧
- [ ] 人际沟通技能
- [ ] 完美主义处理
- [ ] 考试焦虑应对

## 📝 实施步骤

### Step 1: 准备环境（10分钟）

```bash
# 1. 确认服务运行
python3 verify_cleanup.py

# 2. 检查知识库
curl http://192.168.66.11:8000/api/v1/datasets
```

### Step 2: 创建数据准备脚本（30分钟）

创建以下脚本：
1. `prepare_psychology_baseline.py` - 对照组数据
2. `prepare_psychology_kb_only.py` - 仅知识库组数据
3. `prepare_psychology_full.py` - 完整系统数据

### Step 3: 准备会话脚本（1小时）

为每个测试组准备 3 个会话的完整对话脚本

### Step 4: 执行测试（1小时）

依次运行三组测试，收集结果

### Step 5: 分析对比（30分钟）

生成对比报告，展示三种系统的差异

## 📈 预期效果展示

### 对照组（无任何记忆）

**会话2开场**：
```
咨询师：你好，今天想聊些什么呢？
（完全不记得之前的咨询内容）
```

### 仅知识库组

**会话2开场**：
```
咨询师：你好，今天想聊些什么呢？我们可以讨论学习压力、
人际关系等青少年常见的心理困扰。
（有专业知识，但不记得用户信息）
```

### 完整系统组

**会话2开场**：
```
咨询师：小婉你好，又见面了。上次我们聊到了你的学习压力，
特别是数学和物理让你感到焦虑。这周你尝试用画画来放松了吗？
感觉怎么样？
（记住姓名、问题、作业，体现连续性）
```

## 🎯 成功标准

### 必须达成
1. ✅ 三组对比测试全部完成
2. ✅ 每个会话至少 10 轮有效交流
3. ✅ 明确展示三种记忆系统的差异
4. ✅ 生成详细的对比分析报告

### 期望达成
1. 🎯 完整系统在个性化和连续性上显著优于对照组
2. 🎯 知识库组在专业性上优于对照组
3. 🎯 Memobase 成功提取用户画像细节
4. 🎯 Mem0 实现跨会话记忆连续性

## 📋 下一步待确认

请确认或补充以下内容：

1. **心理咨询师提示词**是否符合要求？需要调整吗？
2. **三个会话场景**的设计是否合理？
3. **对比测试方案**是否清晰？需要增加测试组吗？
4. **测试指标**是否全面？
5. 是否需要调整会话轮数或场景内容？
6. 是否需要增加其他测试维度？

确认后，我将立即开始实施：
- [ ] 创建数据准备脚本
- [ ] 编写完整会话脚本
- [ ] 实现自动化测试流程
- [ ] 生成对比分析报告

---

**等待你的反馈和补充！** 🎯
和补充！** 🎯
