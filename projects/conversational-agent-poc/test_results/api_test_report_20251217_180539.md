# API端点测试报告

**测试时间**: 2025-12-17 18:05:39

**总测试数**: 17

**成功**: 15

**失败**: 2

---

## Cognee API

### Cognee Health Check ✅ 成功

**描述**: Cognee服务健康检查

**方法**: GET

**URL**: `http://192.168.66.11:8000/health`

**HTTP状态码**: 200

**响应**:

```json
{
  "status": "ready",
  "health": "healthy",
  "version": "0.4.1-local"
}
```

---

### Cognee Search Knowledge ✅ 成功

**描述**: 从Cognee知识库搜索知识（数据集: kb_tech）

**方法**: POST

**URL**: `http://192.168.66.11:8000/api/v1/search`

**请求数据**:

```json
{
  "query": "Python编程基础",
  "datasets": [
    "kb_tech"
  ],
  "search_type": "GRAPH_COMPLETION",
  "top_k": 5
}
```

**HTTP状态码**: 200

**响应**:

```json
['Python 编程基础包括以下几个重要方面：\n\n1. **基本语法**：Python 是一种高级、解释型、通用的编程语言，强调代码可读性和简洁性。\n\n2. **变量与数据类型**：Python 支持整数、浮点数、字符串和布尔值等基本数据类型，以及动态类型特性。\n\n3. **运算符**：包括算术运算符、比较运算符和逻辑运算符。\n\n4. **控制流语句**：使用 if-elif-else 条件语句、for 循环和 while 循环等。\n\n5. **输入输出**：使用 `print()` 输出和 `input()` 获取用户输入。\n\n6. **注释**：支持单行和多行注释，有助于代码的可读性。\n\n7. **错误处理**：使用异常机制，例如 try-except 语句来处理运行时错误。\n\n8. **函数**：支持定义和使用函数，包括参数和返回值。']
```

---

### Cognee List Datasets ✅ 成功

**描述**: 列出Cognee中的所有数据集

**方法**: GET

**URL**: `http://192.168.66.11:8000/api/v1/datasets`

**HTTP状态码**: 200

**响应**:

```json
[{'id': '432ee6e2-454b-53ab-9974-3bd4c5f9831b', 'name': 'kb_tech', 'createdAt': '2025-12-17T09:10:15.572827Z', 'updatedAt': None, 'ownerId': '73ab78eb-b9cf-471f-9f87-dce6b6b95b9e'}]
```

---

## Memobase API

### Memobase Health Check ❌ 失败

**描述**: Memobase服务健康检查（如果支持）

**方法**: GET

**URL**: `http://192.168.66.11:8019/health`

**HTTP状态码**: 404

**错误**: HTTP 404

**响应**:

```json
{
  "detail": "Not Found"
}
```

---

## Mem0 API

### Mem0 Health Check ❌ 失败

**描述**: Mem0服务健康检查

**方法**: GET

**URL**: `http://192.168.66.11:8888/health`

**HTTP状态码**: 404

**错误**: HTTP 404

**响应**:

```json
{
  "detail": "Not Found"
}
```

---

### Mem0 Search Memories (Current Session) ✅ 成功

**描述**: 搜索当前会话的记忆

**方法**: POST

**URL**: `http://192.168.66.11:8888/api/v1/search`

**请求数据**:

```json
{
  "query": "用户信息",
  "user_id": "test_user_001",
  "agent_id": "test_session_001"
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "results": [
    {
      "id": "a71d7eb5-7d37-46e1-89a5-55a73ad51785",
      "memory": "Name is 测试用户",
      "hash": "e822a25bcd9e5e75a6f1486a01b91450",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.45364118,
      "created_at": "2025-12-17T01:41:55.170029-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "6603e51b-58e2-4492-b95f-82833f3c890a",
      "memory": "Is a 软件工程师",
      "hash": "356e29e127d35bc285b93f7c2bd4c8a5",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.24698827,
      "created_at": "2025-12-17T01:41:55.203478-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "1d941335-7eff-463d-9129-738b52d8f01c",
      "memory": "喜欢Python编程",
      "hash": "96ca3252066b2dd050fc5212e1e7827c",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.18261509,
      "created_at": "2025-12-17T01:41:27.890583-08:00",
      "updated_at": "2025-12-17T01:41:54.580455-08:00",
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "436cb20b-d1d9-405d-8670-cc50c9942712",
      "memory": "对Python很感兴趣",
      "hash": "14bbbfdec28b049925c662bb55447e1a",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.12681678,
      "created_at": "2025-12-17T01:41:55.215802-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    }
  ]
}
```

---

### Mem0 Search Memories (Cross Session) ✅ 成功

**描述**: 搜索跨会话的记忆

**方法**: POST

**URL**: `http://192.168.66.11:8888/api/v1/search`

**请求数据**:

```json
{
  "query": "用户信息",
  "user_id": "test_user_001"
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "results": [
    {
      "id": "a71d7eb5-7d37-46e1-89a5-55a73ad51785",
      "memory": "Name is 测试用户",
      "hash": "e822a25bcd9e5e75a6f1486a01b91450",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.4535851,
      "created_at": "2025-12-17T01:41:55.170029-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "07479764-f267-438e-a192-0d2f80de2e61",
      "memory": "Name is 测试用户",
      "hash": "e822a25bcd9e5e75a6f1486a01b91450",
      "metadata": null,
      "score": 0.4535851,
      "created_at": "2025-12-17T01:24:46.711307-08:00",
      "updated_at": null,
      "user_id": "test_user_001"
    },
    {
      "id": "6603e51b-58e2-4492-b95f-82833f3c890a",
      "memory": "Is a 软件工程师",
      "hash": "356e29e127d35bc285b93f7c2bd4c8a5",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.24693939,
      "created_at": "2025-12-17T01:41:55.203478-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "1d941335-7eff-463d-9129-738b52d8f01c",
      "memory": "喜欢Python编程",
      "hash": "96ca3252066b2dd050fc5212e1e7827c",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.18253317,
      "created_at": "2025-12-17T01:41:27.890583-08:00",
      "updated_at": "2025-12-17T01:41:54.580455-08:00",
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "436cb20b-d1d9-405d-8670-cc50c9942712",
      "memory": "对Python很感兴趣",
      "hash": "14bbbfdec28b049925c662bb55447e1a",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.12670635,
      "created_at": "2025-12-17T01:41:55.215802-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    }
  ]
}
```

---

### Mem0 Create Memory ✅ 成功

**描述**: 创建新的记忆

**方法**: POST

**URL**: `http://192.168.66.11:8888/api/v1/memories`

**请求数据**:

```json
{
  "messages": [
    {
      "role": "user",
      "content": "我是测试用户，喜欢Python编程"
    },
    {
      "role": "assistant",
      "content": "好的，我记住了"
    }
  ],
  "user_id": "test_user_001",
  "agent_id": "test_session_001"
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "results": []
}
```

---

### Mem0 Search Memories (After Create) ✅ 成功

**描述**: 创建记忆后再次搜索，验证记忆是否保存成功

**方法**: POST

**URL**: `http://192.168.66.11:8888/api/v1/search`

**请求数据**:

```json
{
  "query": "Python编程",
  "user_id": "test_user_001",
  "agent_id": "test_session_001"
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "results": [
    {
      "id": "1d941335-7eff-463d-9129-738b52d8f01c",
      "memory": "喜欢Python编程",
      "hash": "96ca3252066b2dd050fc5212e1e7827c",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.65524775,
      "created_at": "2025-12-17T01:41:27.890583-08:00",
      "updated_at": "2025-12-17T01:41:54.580455-08:00",
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "436cb20b-d1d9-405d-8670-cc50c9942712",
      "memory": "对Python很感兴趣",
      "hash": "14bbbfdec28b049925c662bb55447e1a",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.5614637,
      "created_at": "2025-12-17T01:41:55.215802-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "6603e51b-58e2-4492-b95f-82833f3c890a",
      "memory": "Is a 软件工程师",
      "hash": "356e29e127d35bc285b93f7c2bd4c8a5",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.25051522,
      "created_at": "2025-12-17T01:41:55.203478-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    },
    {
      "id": "a71d7eb5-7d37-46e1-89a5-55a73ad51785",
      "memory": "Name is 测试用户",
      "hash": "e822a25bcd9e5e75a6f1486a01b91450",
      "metadata": {
        "dataset_names": [
          "kb_tech"
        ],
        "timestamp": "2025-12-17T17:41:46.214234"
      },
      "score": 0.22843662,
      "created_at": "2025-12-17T01:41:55.170029-08:00",
      "updated_at": null,
      "user_id": "test_user_001",
      "agent_id": "test_session_001"
    }
  ]
}
```

---

## POC API

### POC Root ✅ 成功

**描述**: POC项目根路径

**方法**: GET

**URL**: `http://localhost:8080/`

**HTTP状态码**: 200

**响应**:

```json
{
  "name": "Conversational Agent POC",
  "version": "0.1.0",
  "status": "running"
}
```

---

### POC Health Check ✅ 成功

**描述**: POC服务健康检查

**方法**: GET

**URL**: `http://localhost:8080/health`

**HTTP状态码**: 200

**响应**:

```json
{
  "status": "healthy"
}
```

---

### POC Debug Status ✅ 成功

**描述**: 查看POC服务状态和配置

**方法**: GET

**URL**: `http://localhost:8080/api/v1/debug/status`

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "services": {
    "cognee": {
      "url": "http://192.168.66.11:8000",
      "initialized": true
    },
    "memobase": {
      "url": "http://192.168.66.11:8019",
      "initialized": true
    },
    "mem0": {
      "url": "http://192.168.66.11:8888",
      "initialized": true
    },
    "openai": {
      "model": "gpt-4",
      "base_url": "https://oneapi.naivehero.top/v1"
    }
  }
}
```

---

### POC First Conversation ✅ 成功

**描述**: 第一次对话，创建用户画像和记忆

**方法**: POST

**URL**: `http://localhost:8080/api/v1/test/conversation`

**请求数据**:

```json
{
  "user_id": "test_user_001",
  "session_id": "test_session_001",
  "message": "你好，我是测试用户，我是一名软件工程师，对Python很感兴趣",
  "dataset_names": [
    "kb_tech"
  ]
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "user_id": "test_user_001",
  "session_id": "test_session_001",
  "message": "你好，我是测试用户，我是一名软件工程师，对Python很感兴趣",
  "response": "你好，测试用户！很高兴你对Python有兴趣。作为一名软件工程师，学习并掌握Python确实是一个非常好的决定。Python以其极高的可读性和简洁的语法而闻名，不仅适合快速开发和原型制作，还在数据科学、机器学习等领域有着广泛的应用。如果你想进一步深入学习Python，我推荐你可以从Python的基础语法开始，逐步掌握其内置的数据类型、控制流语句、函数等核心概念，同时，有很多优秀的在线教程和课程可以作为你的学习资源。祝你在Python的学习路上一切顺利！",
  "context": {
    "user_profile": {},
    "session_memories_count": 9,
    "knowledge_count": 1,
    "session_memories": [
      {
        "content": "对Python很感兴趣",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.215802-08:00"
      },
      {
        "content": "对Python很感兴趣",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.215802-08:00"
      },
      {
        "content": "Is a 软件工程师",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.203478-08:00"
      },
      {
        "content": "Is a 软件工程师",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.203478-08:00"
      },
      {
        "content": "Name is 测试用户",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.170029-08:00"
      }
    ],
    "knowledge": [
      {
        "content": "你好！作为一名软件工程师，对Python的兴趣是非常好的选择。Python是一种高级编程语言，以其可读性和简洁性而闻名。它非常适合于快速开发和原型制作，同时在数据科学、机器学习等领域也有广泛的应用。如果你想进一步学习Python，可以参考Python的基础语法和相关教程。祝你在学习和使用Python的过程中取得成功！",
        "score": 1.0,
        "source": "kb_tech"
      }
    ],
    "debug": null
  },
  "dataset_names": [
    "kb_tech"
  ]
}
```

---

### POC Get User Profile ✅ 成功

**描述**: 获取用户画像

**方法**: GET

**URL**: `http://localhost:8080/api/v1/users/test_user_001/profile`

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "user_id": "test_user_001",
  "profile": {}
}
```

---

### POC Second Conversation (Memory Test) ✅ 成功

**描述**: 第二次对话，测试记忆功能

**方法**: POST

**URL**: `http://localhost:8080/api/v1/test/conversation`

**请求数据**:

```json
{
  "user_id": "test_user_001",
  "session_id": "test_session_001",
  "message": "我之前说过我的职业是什么？",
  "dataset_names": [
    "kb_tech"
  ]
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "user_id": "test_user_001",
  "session_id": "test_session_001",
  "message": "我之前说过我的职业是什么？",
  "response": "您之前提到过，您的职业是软件工程师。",
  "context": {
    "user_profile": {},
    "session_memories_count": 9,
    "knowledge_count": 1,
    "session_memories": [
      {
        "content": "对Python很感兴趣",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.215802-08:00"
      },
      {
        "content": "对Python很感兴趣",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.215802-08:00"
      },
      {
        "content": "Is a 软件工程师",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.203478-08:00"
      },
      {
        "content": "Is a 软件工程师",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.203478-08:00"
      },
      {
        "content": "Name is 测试用户",
        "type": "semantic",
        "session": "current",
        "timestamp": "2025-12-17T01:41:55.170029-08:00"
      }
    ],
    "knowledge": [
      {
        "content": "The context does not provide specific information about your profession. It mentions various career paths such as doctor, teacher, nurse, architect, lawyer, and military member, but does not indicate which one is yours.",
        "score": 1.0,
        "source": "kb_tech"
      }
    ],
    "debug": null
  },
  "dataset_names": [
    "kb_tech"
  ]
}
```

---

### POC New Session (Cross-Session Memory) ✅ 成功

**描述**: 新会话，测试跨会话记忆

**方法**: POST

**URL**: `http://localhost:8080/api/v1/test/conversation`

**请求数据**:

```json
{
  "user_id": "test_user_001",
  "session_id": "test_session_002",
  "message": "你还记得我的职业吗？",
  "dataset_names": [
    "kb_tech"
  ]
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "user_id": "test_user_001",
  "session_id": "test_session_002",
  "message": "你还记得我的职业吗？",
  "response": "当然，您是一名软件工程师，特别擅长Python编程。",
  "context": {
    "user_profile": {},
    "session_memories_count": 4,
    "knowledge_count": 1,
    "session_memories": [
      {
        "content": "Is a 软件工程师",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.203478-08:00"
      },
      {
        "content": "Name is 测试用户",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:55.170029-08:00"
      },
      {
        "content": "喜欢Python编程",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:41:27.890583-08:00"
      },
      {
        "content": "Name is 测试用户",
        "type": "semantic",
        "session": "cross",
        "timestamp": "2025-12-17T01:24:46.711307-08:00"
      }
    ],
    "knowledge": [
      {
        "content": "你的职业是与音频和语音识别相关的，尤其是作为Icefall ASR Zipformer模型的创造者。",
        "score": 1.0,
        "source": "kb_tech"
      }
    ],
    "debug": null
  },
  "dataset_names": [
    "kb_tech"
  ]
}
```

---

### POC Send Message (Standard API) ✅ 成功

**描述**: 发送消息并获取响应（标准接口）

**方法**: POST

**URL**: `http://localhost:8080/api/v1/conversations/test_session_001/messages`

**请求数据**:

```json
{
  "message": "Python有哪些常用的数据结构？",
  "user_id": "test_user_001",
  "session_id": "test_session_001",
  "dataset_names": [
    "kb_tech"
  ]
}
```

**HTTP状态码**: 200

**响应**:

```json
{
  "success": true,
  "session_id": "test_session_001",
  "response": "Python常用的数据结构包括：\n\n1. **列表 (List)**：有序、可变的元素集合。你可以改变列表的元素，以及添加或删除元素。\n2. **元组 (Tuple)**：有序、不可变的元素集合。一旦创建，你就不能更改元组的元素。\n3. **字典 (Dict)**：键值对的集合，键必须唯一且不可变。字典可以用于存储和查找数据，以键为索引。\n4. **集合 (Set)**：无序、不重复元素的集合。集合中的元素都是唯一的，非常适合做去重操作。\n\n这些数据结构都有各自的特点和适用场景，你可以根据实际需求选择使用。",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

---

